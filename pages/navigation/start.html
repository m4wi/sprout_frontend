<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio - GreenPoints</title>
    <!-- Leaflet para el mapa -->
    <script src="/public/js/leaflet.js"></script>
    <link rel="stylesheet" href="/public/css/leaflet.css">
    <!-- Estilos -->
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/start.css">
</head>

<body>
    <img src="/assets/images/ballena.webp" alt="imagen background" class="background-doodle">
    <div id="header-container"></div>
    <main>
        <section>
            <!-- MODO B칔SQUEDA -->
            <div id="searchModeContent">
                <!-- Barra de b칰squeda y usuario -->
                <div class="search-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                    </svg>
                    <input type="search" placeholder="Buscar puntos de reciclaje...">

                    <div class="user-notifications">
                        <div class="notification-icon" id="notificationBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="currentColor"
                                    d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z" />
                            </svg>
                            <span class="notification-badge" id="notificationCount" style="display: none;">0</span>

                            <!-- Popup de notificaciones -->
                            <div class="notification-popup" id="notificationPopup">
                                <div class="popup-header">
                                    <h3>Notificaciones</h3>
                                    <button class="mark-read-btn" id="markAllReadBtn">Marcar todo como le칤do</button>
                                </div>
                                <div class="popup-content" id="notificationList">
                                    <!-- Items din치micos -->
                                </div>
                            </div>
                        </div>
                        <img src="" alt="Usuario" class="user-avatar" id="userAvatar">
                    </div>
                </div>

                <!-- Filtros -->
                <div class="filters-section">
                    <p>Filtros</p>
                    <div class="filter-buttons">
                        <button class="active" data-category="all">Todos</button>
                        <button data-category="plastic" data-id="1">Pl치stico</button>
                        <button data-category="paper" data-id="2">Papel</button>
                        <button data-category="glass" data-id="4">Vidrio</button>
                        <button data-category="metal" data-id="3">Metal</button>
                        <button data-category="organic" data-id="5">Org치nico</button>
                        <button id="btn-geolocalizacion">游늸 B칰squeda Avanzada</button>
                    </div>
                </div>

                <!-- B칰squeda por Geolocalizaci칩n (Oculto por defecto) -->
                <div class="geolocation-search-container" id="geolocationSearch" style="display: none;">
                    <h3>B칰squeda por Ubicaci칩n</h3>
                    <div class="geo-inputs">
                        <input type="number" id="geoLat" placeholder="Latitud" step="any">
                        <input type="number" id="geoLng" placeholder="Longitud" step="any">
                    </div>
                    <div class="geo-actions">
                        <button id="btn-select-map-geo" class="geo-btn">游늸 Seleccionar en Mapa</button>
                        <button id="btn-use-current-geo" class="geo-btn">游꿢 Mi Ubicaci칩n</button>
                        <button id="btn-search-geo-action" class="geo-btn primary">Buscar</button>
                        <button id="btn-cancel-geo" class="geo-btn cancel">Cancelar</button>
                    </div>
                </div>

                <!-- Contenedor para resultados (opcional) -->
                <div class="results-container" id="resultsContainer" style="display: none;">
                    <!-- Los resultados se mostrar치n aqu칤 -->
                </div>
            </div>

            <!-- MODO AGREGAR (Oculto por defecto) -->
            <div id="addModeContent" style="display: none;">
                <div class="filters-section">
                    <h2>Registrar Nuevo GreenPoint</h2>
                    <p>Selecciona la ubicaci칩n en el mapa y completa los datos.</p>
                    <form id="addGreenpointForm" class="add-form">
                        <!-- Basic Info -->
                        <div class="form-group">
                            <label>Descripci칩n</label>
                            <input type="text" id="gpDescription" placeholder="Ej: Contenedor en la plaza" required>
                        </div>
                        <div class="form-group">
                            <label>Direcci칩n</label>
                            <input type="text" id="gpDirection" placeholder="Ej: Av. Bolognesi 123" required>
                        </div>
                        <div class="form-group">
                            <label>Horario de Atenci칩n</label>
                            <input type="text" id="gpHour" placeholder="Ej: 9:00 AM - 6:00 PM">
                        </div>
                        <div class="form-group">
                            <label>Fecha de Recogida</label>
                            <input type="date" id="gpDateCollect" class="styled-date-input">
                        </div>

                        <!-- Categories -->
                        <div class="form-group">
                            <label>Categor칤as</label>
                            <div class="checkbox-group" id="gpCategoriesContainer">
                                <label class="category-checkbox" style="--cat-color: #4CAF50;">
                                    <input type="checkbox" value="1">
                                    <span>Pl치stico</span>
                                </label>
                                <label class="category-checkbox" style="--cat-color: #FF9800;">
                                    <input type="checkbox" value="2">
                                    <span>Cart칩n</span>
                                </label>
                                <label class="category-checkbox" style="--cat-color: #607D8B;">
                                    <input type="checkbox" value="3">
                                    <span>Metal</span>
                                </label>
                                <label class="category-checkbox" style="--cat-color: #2196F3;">
                                    <input type="checkbox" value="4">
                                    <span>Vidrio</span>
                                </label>
                                <label class="category-checkbox" style="--cat-color: #795548;">
                                    <input type="checkbox" value="5">
                                    <span>Papel</span>
                                </label>
                            </div>
                        </div>

                        <!-- Materials -->
                        <div class="form-group">
                            <label>Materiales</label>
                            <ul id="materialsList" class="materials-list">
                                <!-- Items added via modal will appear here -->
                            </ul>
                            <button type="button" id="btnAddMaterial" class="secondary-btn">+ Agregar Material</button>
                        </div>

                        <!-- Images -->
                        <div class="form-group">
                            <label>Im치genes</label>
                            <div class="image-upload-container">
                                <label for="gpImages" class="drop-area">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                        <path fill="currentColor"
                                            d="M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5l5 5z" />
                                    </svg>
                                    <span>Subir Im치genes</span>
                                    <input type="file" id="gpImages" multiple accept="image/*" hidden>
                                </label>
                                <div id="imagePreviewContainer" class="image-preview-container"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Coordenadas</label>
                            <input type="text" id="gpCoords" placeholder="Selecciona en el mapa" readonly required>
                        </div>
                        <button type="submit" class="submit-btn">Registrar GreenPoint</button>
                    </form>
                </div>
            </div>

            <!-- Modal for Materials -->
            <div id="materialModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h3>Agregar Material</h3>
                    <div class="form-group">
                        <label>Cantidad</label>
                        <input type="number" id="matQuantity" step="0.001" required>
                    </div>
                    <div class="form-group">
                        <label>Unidad</label>
                        <select id="matUnit" style="padding: 0.75rem; border-radius: 12px; border: 2px solid #e8f5e9;">
                            <option value="kg">Kg</option>
                            <option value="unit">Unidad</option>
                            <option value="lt">Litros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Descripci칩n</label>
                        <input type="text" id="matDescription" placeholder="Detalles del material">
                    </div>
                    <button type="button" id="btnSaveMaterial" class="primary-btn">Guardar Material</button>
                </div>
            </div>
        </section>
        <section style="position: relative;">
            <div id="map"></div>
            <!-- Bot칩n flotante para cambiar de modo -->
            <button id="toggleModeBtn" class="toggle-mode-btn" title="Agregar GreenPoint">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M11 13H5v-2h6V5h2v6h6v2h-6v6h-2z" />
                </svg>
            </button>
        </section>
    </main>
    <footer>
        <p class="info">춸 2025 GreenPoints. Todos los derechos reservados.</p>
        <nav class="links">
            <a href="/about">Acerca</a>
            <a href="/contact">Contacto</a>
            <a href="/privacy">Privacidad</a>
        </nav>
    </footer>
    <script type="module" src="/js/scripts/start.js"></script>
    <script src="/js/components.js"></script>
</body>

</html>